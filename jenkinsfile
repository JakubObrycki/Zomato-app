pipeline {
  agent any

  environment {
    DOCKER_CREDENTIALS = credentials('jen-dockerhub')
    SCANNER_HOME = tool 'sonar-scanner'
  }

  stages {
    stage('Git checkout') {
      steps {
          checkout scmGit(branches: [[name: '*/main']], extensions: [], userRemoteConfigs: [[credentialsId: 'jen-doc-token', url: 'https://github.com/JakubObrycki/Zomato-app.git']])
        }
      }
    stage('Sonarqube analysis') {
        steps {
          withSonarQubeEnv ('sonar-server') {
            sh '''${SCANNER_HOME}/bin/sonar-scanner -Dsonar.projectName=Zomato-app \
            -Dsonar.projectKey=Zomato-app'''
          }
        }
      }
    }
  }
